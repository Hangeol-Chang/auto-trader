# Test Scripts

μ΄ ν΄λ”λ” auto-trader μ‹μ¤ν…μ λ‹¤μ–‘ν• κΈ°λ¥μ„ ν…μ¤νΈν•κΈ° μ„ν• μ¤ν¬λ¦½νΈλ“¤μ„ ν¬ν•¨ν•©λ‹λ‹¤.

## π“ νμΌ κµ¬μ„±

### Python ν…μ¤νΈ μ¤ν¬λ¦½νΈ

#### `test_stock_signal.py`
- **λ©μ **: KIS APIλ¥Ό ν†µν• μ£Όμ‹ κ±°λ μ‹ νΈ ν…μ¤νΈ
- **κΈ°λ¥**: 
  - μ£Όμ‹ λ§¤μ/λ§¤λ„ μ‹ νΈ μ „μ†΅
  - μ§€μ •κ°€/μ‹μ¥κ°€ μ£Όλ¬Έ ν…μ¤νΈ
  - μ£Όμ‹ μ”κ³  μ΅°ν
  - μ£Όμ‹ ν„μ¬κ°€ μ΅°ν
- **μ‚¬μ©λ²•**: `python test/test_stock_signal.py`

#### `test_ta_signal.py`
- **λ©μ **: μ‹ κ· TradingView Signal API ν…μ¤νΈ (λ κ±°μ‹ ta-signal λ€μ²΄)
- **κΈ°λ¥**:
  - μ‹ κ· `/api/tradingview/signal` μ—”λ“ν¬μΈνΈ ν…μ¤νΈ
  - μ•”νΈν™”ν μ§€μ •κ°€/μ‹μ¥κ°€ λ§¤μ/λ§¤λ„ ν…μ¤νΈ
  - κ°„μ†ν™”λ νμ΄λ΅λ“ κµ¬μ΅° μ‚¬μ©
  - ν–¥μƒλ μ—λ¬ μ²λ¦¬ λ° μ‘λ‹µ ν™•μΈ
- **API λ³€κ²½μ‚¬ν•­**:
  - λ κ±°μ‹: `/ta-signal` β†’ μ‹ κ·: `/api/tradingview/signal`
  - μ¤‘μ²©λ κ°μ²΄ κµ¬μ΅° μ κ±°
  - μ§μ ‘μ μΈ ticker/action/price/quantity ν•„λ“ μ‚¬μ©
- **μ‚¬μ©λ²•**: `python test/test_ta_signal.py`

#### `test_pine_script.py`
- **λ©μ **: Pine Script μ „λµ ν…μ¤νΈ
- **κΈ°λ¥**:
  - Pine Script κΈ°λ° μ „λµ κ²€μ¦
  - λ°±ν…μ¤ν… κ²°κ³Ό ν™•μΈ
- **μ‚¬μ©λ²•**: `python test/test_pine_script.py`

#### `test.py`
- **λ©μ **: μΌλ°μ μΈ μ‹μ¤ν… κΈ°λ¥ ν…μ¤νΈ
- **κΈ°λ¥**:
  - κΈ°λ³Έ API μ—°κ²° ν…μ¤νΈ
  - μ‹μ¤ν… μƒνƒ ν™•μΈ
- **μ‚¬μ©λ²•**: `python test/test.py`

### JSON ν…μ¤νΈ λ°μ΄ν„°

#### `test_stock_requests.json`
- **λ©μ **: μ£Όμ‹ κ±°λ API ν…μ¤νΈμ© JSON μƒν”
- **λ‚΄μ©**:
  - μ£Όμ‹ λ§¤μ/λ§¤λ„ μ‹ νΈ μƒν”
  - μΈκΈ° ν•κµ­ μ£Όμ‹ μΆ…λ© μ½”λ“
  - curl λ…λ Ήμ–΄ μμ 
  - TradingView μ›Ήν›… μ‹λ®¬λ μ΄μ… λ°μ΄ν„°

#### `test_requests.json`
- **λ©μ **: μ‹ κ· API ν…μ¤νΈμ© JSON μƒν” (λ κ±°μ‹ ta-signal λ€μ²΄)
- **λ‚΄μ©**:
  - μ‹ κ· `/api/tradingview/signal` API μƒν”
  - κ°„μ†ν™”λ νμ΄λ΅λ“ κµ¬μ΅°
  - μ•”νΈν™”ν κ±°λ μ‹ νΈ μƒν” (μ§€μ •κ°€/μ‹μ¥κ°€)
  - λ‹¤μ–‘ν• API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ λ°μ΄ν„°
  - curl λ…λ Ήμ–΄ μμ 
  - API λ§μ΄κ·Έλ μ΄μ… κ°€μ΄λ“

## π€ λΉ λ¥Έ μ‹μ‘

### 1. μ „μ²΄ μ‹μ¤ν… ν…μ¤νΈ
```bash
# μ„λ²„ μ‹¤ν–‰ (λ³„λ„ ν„°λ―Έλ„)
python main.py

# μ£Όμ‹ κ±°λ μ‹μ¤ν… ν…μ¤νΈ
python test/test_stock_signal.py

# μ•”νΈν™”ν κ±°λ μ‹μ¤ν… ν…μ¤νΈ
python test/test_ta_signal.py
```

### 2. κ°λ³„ κΈ°λ¥ ν…μ¤νΈ
```bash
# Pine Script μ „λµ ν…μ¤νΈ
python test/test_pine_script.py

# κΈ°λ³Έ μ‹μ¤ν… κΈ°λ¥ ν…μ¤νΈ
python test/test.py
```

### 3. API ν…μ¤νΈ (curl) - μ‹ κ· API
```bash
# μ‹ κ· μ•”νΈν™”ν λ§¤μ μ‹ νΈ
curl -X POST http://localhost:5000/api/tradingview/signal \
  -H "Content-Type: application/json" \
  -d '{"ticker":"BTCKRW","action":"buy","price":95000000,"quantity":0.001,"strategy":"Test"}'

# μ‹ κ· μ•”νΈν™”ν λ§¤λ„ μ‹ νΈ  
curl -X POST http://localhost:5000/api/tradingview/signal \
  -H "Content-Type: application/json" \
  -d '{"ticker":"BTCKRW","action":"sell","price":94000000,"quantity":0.001,"strategy":"Test"}'

# μ•”νΈν™”ν μ”κ³  μ΅°ν
curl -X GET http://localhost:5000/api/trading/balance

# μ£Όμ‹ κ±°λ API (test_stock_requests.json μ°Έμ΅°)
curl -X GET http://localhost:5000/api/trading/stock-price/005930
```

## π“‹ ν…μ¤νΈ μ‹λ‚λ¦¬μ¤

### μ£Όμ‹ κ±°λ ν…μ¤νΈ μμ„
1. μ„λ²„ μƒνƒ ν™•μΈ
2. μ£Όμ‹ ν„μ¬κ°€ μ΅°ν
3. μ£Όμ‹ μ”κ³  μ΅°ν
4. μ‹μ¥κ°€ λ§¤μ μ£Όλ¬Έ
5. μ§€μ •κ°€ λ§¤μ μ£Όλ¬Έ
6. μ§€μ •κ°€ λ§¤λ„ μ£Όλ¬Έ
7. μ‹μ¥κ°€ λ§¤λ„ μ£Όλ¬Έ

### μ•”νΈν™”ν κ±°λ ν…μ¤νΈ μμ„ (μ‹ κ· API)
1. TradingView/Trading API μƒνƒ ν™•μΈ
2. μ§€μ› λ§μΌ“ μ΅°ν
3. μ•”νΈν™”ν μ”κ³  μ΅°ν
4. μ‹ νΈ ν…μ¤νΈ μ—”λ“ν¬μΈνΈ ν™•μΈ
5. μ§€μ •κ°€ λ§¤μ/λ§¤λ„ μ‹ νΈ ν…μ¤νΈ
6. μ‹μ¥κ°€ λ§¤μ/λ§¤λ„ μ‹ νΈ ν…μ¤νΈ

### API λ§μ΄κ·Έλ μ΄μ… μ •λ³΄
- **λ κ±°μ‹ μ—”λ“ν¬μΈνΈ**: `/ta-signal`
- **μ‹ κ· μ—”λ“ν¬μΈνΈ**: `/api/tradingview/signal`
- **μ£Όμ” λ³€κ²½μ‚¬ν•­**:
  - κ°„μ†ν™”λ νμ΄λ΅λ“ κµ¬μ΅°
  - μ§μ ‘μ μΈ ticker/action/price/quantity ν•„λ“
  - timestamp λ° exchange ν•„λ“ μ¶”κ°€
  - μ¤‘μ²©λ strategy/instrument/order κ°μ²΄ μ κ±°
  - ν–¥μƒλ μ—λ¬ μ²λ¦¬ λ° μ‘λ‹µ ν•μ‹

## β οΈ μ£Όμμ‚¬ν•­

- **μ‹¤μ  κ±°λ μ£Όμ**: ν…μ¤νΈ μ¤ν¬λ¦½νΈλ” μ‹¤μ  κ±°λλ¥Ό μν–‰ν•  μ μμµλ‹λ‹¤. λ¨μ κ³„μΆλ‚ μ†μ•΅μΌλ΅ ν…μ¤νΈν•μ„Έμ”.
- **API ν‚¤ μ„¤μ •**: ν…μ¤νΈ μ „μ— `private/keys.json`μ— μ¬λ°”λ¥Έ API ν‚¤κ°€ μ„¤μ •λμ–΄ μλ”μ§€ ν™•μΈν•μ„Έμ”.
- **μ„λ²„ μ‹¤ν–‰**: λ€λ¶€λ¶„μ ν…μ¤νΈλ” μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΌ λ•λ§ λ™μ‘ν•©λ‹λ‹¤.
- **μ‹μ¥ μ‹κ°„**: μ£Όμ‹ κ±°λ ν…μ¤νΈλ” μ¥μ¤‘μ—λ§ μ •μƒ λ™μ‘ν•  μ μμµλ‹λ‹¤.

## π”§ νΈλ¬λΈ”μν…

### μΌλ°μ μΈ λ¬Έμ 
- **403 Forbidden**: API ν‚¤ ν™•μΈ ν•„μ”
- **Connection Error**: μ„λ²„ μ‹¤ν–‰ μƒνƒ ν™•μΈ
- **Timeout**: λ„¤νΈμ›ν¬ μ—°κ²° μƒνƒ ν™•μΈ
- **Invalid Request**: JSON ν¬λ§· λ° ν•„μ ν•„λ“ ν™•μΈ

### λ””λ²„κΉ… ν
- κ° ν…μ¤νΈ μ¤ν¬λ¦½νΈλ” μƒμ„Έν• λ΅κ·Έλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤
- `logs/` ν΄λ”μ μ„λ²„ λ΅κ·Έλ¥Ό ν™•μΈν•μ„Έμ”
- Discord μ•λ¦Όμ΄ ν™μ„±ν™”λμ–΄ μλ‹¤λ©΄ κ±°λ κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤
